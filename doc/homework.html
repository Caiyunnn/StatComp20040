<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SC20040" />

<meta name="date" content="2020-12-19" />

<title>Homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">SC20040</h4>
<h4 class="date">2020-12-19</h4>



<div id="section" class="section level1">
<h1><font color="Teal">2020/09/22</font></h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>The 1st example should contain texts and at least one figure. The 2nd example should contains texts and at least one table. The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>例一：利用R的内置数据集sleep，通过用两种颜色和形状的散点图和拟合的平滑的线条来分别表现两种药物对于十位病人的睡眠改善情况，横坐标patientsID的取值范围为1-10，分别对应十位病人，纵坐标为increase in hours of sleep，表示服用药物后的睡时长增减情况，蓝色表示 药物1的作用效果，红色代表药物2的作用效果，绿色水平辅助线帮助总体上辨别出病人睡眠状况恶化的样本点。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(car)</span></code></pre></div>
<pre><code>## 载入需要的程辑包：carData</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">attach</span>(sleep)                                                        <span class="co">#加载数据                                                                                      </span></span>
<span id="cb3-2"><a href="#cb3-2"></a>data=sleep                                                </span>
<span id="cb3-3"><a href="#cb3-3"></a>data<span class="op">$</span>ID=<span class="kw">as.numeric</span>(sleep<span class="op">$</span>ID)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">scatterplot</span>(extra<span class="op">~</span>ID<span class="op">|</span>group,<span class="dt">data=</span>data, <span class="dt">main=</span> <span class="st">&quot;two drugs&#39;effect&quot;</span>,      <span class="co">#创建散点图</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>            <span class="dt">legend =</span> <span class="kw">list</span>(<span class="dt">coords=</span><span class="st">&quot;topleft&quot;</span>),<span class="dt">boxplot=</span><span class="st">&#39;y&#39;</span>,             <span class="co">#设置图像的参数</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>            <span class="dt">xlab =</span> <span class="st">&quot;patientsID&quot;</span>,<span class="dt">regLine=</span><span class="ot">FALSE</span>,                       </span>
<span id="cb3-7"><a href="#cb3-7"></a>            <span class="dt">ylab =</span> <span class="st">&quot;increase in hours of sleep&quot;</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">1</span>)                               <span class="co">#增加直线：Y=0</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">detach</span>(sleep)</span></code></pre></div>
<p>例二使用了R内部的数据集women,先进行身高关于体重的回归，然后利用kable将其方差分析的结果以表格的形式展现出来。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">data</span>(women)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">attach</span>(women)                                             <span class="co">#加载数据集</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw">library</span>(knitr)                                            <span class="co">#加载包</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>lm.D1 =<span class="st"> </span><span class="kw">lm</span>(height<span class="op">~</span>weight,<span class="dt">data =</span> women)                    <span class="co">#回归</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">anova</span>(lm.D1),<span class="dt">caption =</span> <span class="st">&quot;方差分析表&quot;</span>)         <span class="co">#生成表格</span></span></code></pre></div>
<table>
<caption>方差分析表</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">Sum Sq</th>
<th align="right">Mean Sq</th>
<th align="right">F value</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">weight</td>
<td align="right">1</td>
<td align="right">277.482753</td>
<td align="right">277.4827532</td>
<td align="right">1433.024</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">13</td>
<td align="right">2.517247</td>
<td align="right">0.1936344</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">detach</span>(women)</span></code></pre></div>
<p>例三为欧拉公式 <span class="math display">\[e^{ix}=cosx+isinx\]</span></p>
</div>
</div>
<div id="section-1" class="section level1">
<h1><font color="Teal">2020/09/29</font></h1>
<div id="question-3.3" class="section level2">
<h2>Question 3.3</h2>
<p>The Pareto(a, b) distribution has cdf <span class="math display">\[F(x)=1−(\frac{b}{x})^{a},  x \ge b&gt;0, a&gt;0.\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
</div>
<div id="answer-3.3" class="section level2">
<h2>Answer 3.3</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)               </span>
<span id="cb7-3"><a href="#cb7-3"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>{<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>}  <span class="co">#the inverse transform method: F(x) = 1-(2/x)^2, x&gt;=2</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="kw">frac</span>(<span class="dv">8</span>,x<span class="op">^</span><span class="dv">3</span>))) <span class="co">#Graph the density histogram of the sample</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">1000</span>, <span class="fl">.01</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">/</span>y<span class="op">^</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.9" class="section level2">
<h2>Question 3.9</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function <span class="math display">\[f_{e}(x)=\frac{3}{4}(1-x^{2}), \left\vert x \right\vert \le 1.\]</span> Devroye and Gyorfi give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_{1},U_{2},U_{3} \sim U(−1, 1)\)</span>. If <span class="math inline">\(\left\vert U_{3} \right\vert \ge \left\vert U_{2} \right\vert\)</span> and <span class="math inline">\(\left\vert U_{3} \right\vert \ge \left\vert U_{1} \right\vert\)</span>, deliver <span class="math inline">\(U_{2}\)</span>; otherwise deliver <span class="math inline">\(U_{3}\)</span>. Write a function to generate random variates from <span class="math inline">\(f_{e}\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-3.9" class="section level2">
<h2>Answer 3.9</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e5</span>;k&lt;-<span class="dv">0</span>;y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb8-3"><a href="#cb8-3"></a>U1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>U2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a>U3 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)                <span class="co">#U1,U2,U3~U(0,1)</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n) {</span>
<span id="cb8-7"><a href="#cb8-7"></a>  k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="cf">if</span> (<span class="kw">abs</span>(U1[k])<span class="op">&lt;=</span><span class="kw">abs</span>(U3[k]) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">abs</span>(U2[k])<span class="op">&lt;=</span><span class="kw">abs</span>(U3[k])) {</span>
<span id="cb8-9"><a href="#cb8-9"></a>  U3[k] &lt;-<span class="st"> </span>U2[k]</span>
<span id="cb8-10"><a href="#cb8-10"></a>  }</span>
<span id="cb8-11"><a href="#cb8-11"></a>} <span class="co">#when |U1|&lt;=|U3|and |U2|&lt;=|U3|，replace U3 with U2</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="kw">hist</span>(U3,  <span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="kw">frac</span>(<span class="dv">3</span>,<span class="dv">4</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>))</span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co"># estimate of a large simulated random sample</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, <span class="fl">.01</span>)</span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="kw">lines</span>(y, (<span class="dv">3</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.10" class="section level2">
<h2>Question 3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_{e} (3.10)\)</span>.</p>
</div>
<div id="answer-3.10" class="section level2">
<h2>Answer 3.10</h2>
<div id="proof" class="section level3">
<h3>proof:</h3>
<p>according to exercise 3.9:</p>
<p><span class="math inline">\(\because U_{1},U_{2},U_{3} \sim U(−1, 1)\)</span></p>
<p><span class="math inline">\(\therefore f(u_1,u_2,u_3)=\frac{1}{8}\)</span></p>
<p><span class="math display">\[\begin{align*}
f_e(x)&amp;=\iint_{\lvert U_{3} \rvert \ge \lvert U_{2} \rvert, \lvert U_{3} \rvert \ge \lvert U_{1} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{3} \\
&amp;+ \iint_{\lvert U_{3} \rvert &lt; \lvert U_{2} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{2}\\
&amp;+\iint_{\lvert U_{3} \rvert &lt; \lvert U_{1} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{2}\\
&amp;-\iint_{\lvert U_{3} \rvert &lt; \lvert U_{2} \rvert, \lvert U_{3} \rvert &lt; \lvert U_{1} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{2}
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
&amp;\iint_{\lvert U_{3} \rvert \ge \lvert U_{2} \rvert, \lvert U_{3} \rvert \ge \lvert U_{1} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{3} \\
=&amp;2\int_{0}^{\lvert x \rvert} 2\int_{\max\{\lvert x \rvert,\lvert u_{1} \rvert\}}^{1} \frac{1}{8}\, du_{3}du_{1}\\
=&amp;\int_{0}^{\lvert x \rvert} \frac{1}{2}(1-\frac{1}{2}(\lvert x \rvert+\lvert u_{1}\rvert+\lvert \lvert x \rvert-\lvert u_{1} \rvert \rvert)\, du_{1}\\
=&amp;\int_{0_{\lvert u_{1} \rvert &lt; \lvert x \rvert}}^{\lvert x \rvert} \frac{1}{2}-\frac{1}{2}\lvert x \rvert \, du_{1}+\int_{0_{\lvert u_{1} \rvert \ge \lvert x \rvert}}^{\lvert x \rvert} \frac{1}{2}-\frac{1}{2}\lvert u_{1} \rvert \, du_{1} \\
=&amp;\frac{1}{4}-\frac{x^2}{4}
\end{align*}\]</span></p>
<p>obviously: <span class="math display">\[\begin{align*}
&amp;\iint_{\lvert U_{3} \rvert &lt; \lvert U_{2} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{2}\\
=&amp;\iint_{\lvert U_{3} \rvert &lt; \lvert U_{1} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{2}\\
=&amp;\int_{-1}^{1} \int_{\lvert x \rvert}^{1}2*\frac{1}{8}du_{1}du_{2}\\
=&amp;\frac{1-\lvert x \rvert}{2}
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
&amp;\iint_{\lvert U_{3} \rvert &lt; \lvert U_{2} \rvert, \lvert U_{3} \rvert &lt; \lvert U_{1} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{2} \\
=&amp;\int_{\lvert x \rvert}^{1} \int_{\lvert x \rvert}^{1} 2*2*\frac{1}{8}du_{1}du_{2}\\
=&amp;\frac{x^2}{2}+\frac{1}{2}-\frac{\lvert x \rvert}{2}
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
\therefore
f_e(x)&amp;=\iint_{\lvert U_{3} \rvert \ge \lvert U_{2} \rvert, \lvert U_{3} \rvert \ge \lvert U_{1} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{3} \\
&amp;+ \iint_{\lvert U_{3} \rvert &lt; \lvert U_{2} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{2}\\
&amp;+\iint_{\lvert U_{3} \rvert &lt; \lvert U_{1} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{2}\\
&amp;-\iint_{\lvert U_{3} \rvert &lt; \lvert U_{2} \rvert, \lvert U_{3} \rvert &lt; \lvert U_{1} \rvert} f(u_{1},u_{2},u_{3})\, du_{1}du_{2}\\
&amp;=\frac{3}{4}(1-x^{2})
\end{align*}\]</span></p>
</div>
</div>
<div id="question-3.13" class="section level2">
<h2>Question 3.13</h2>
<p>It can be shown Exponential-Gamma mixture has a Pareto distribution with cdf <span class="math display">\[F(y)=1-(\frac{\beta}{\beta+y})^{r}, y \ge 0.\]</span> Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(β = 2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-3.13" class="section level2">
<h2>Answer 3.13</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e5</span>; r &lt;-<span class="st"> </span><span class="dv">4</span>; beta &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n, r, beta)</span>
<span id="cb9-4"><a href="#cb9-4"></a>x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, lambda) <span class="co"># the length of lambda = n</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="kw">frac</span>(<span class="dv">64</span>,(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>)),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co"># the density histogram of the sample </span></span>
<span id="cb9-7"><a href="#cb9-7"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="fl">.01</span>)</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="kw">lines</span>(y, <span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-2" class="section level1">
<h1><font color="Teal">2020/10/13</font></h1>
<div id="question-5.1" class="section level2">
<h2>Question 5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_0^{\frac{\pi}{3}} \sin tdt\]</span></p>
</div>
<div id="answer-5.1" class="section level2">
<h2>Answer 5.1</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb10-2"><a href="#cb10-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e5</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)         <span class="co">#generate random x~u(0,pi/3)</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x))<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>         <span class="co">#Monte Carlo estimate</span></span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a> <span class="co">#creat a table to compare estimation with exact value</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">c</span>(theta.hat,<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">cos</span>(<span class="dv">0</span>)),<span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&#39;estimate&#39;</span>,<span class="st">&#39;exact&#39;</span>)),<span class="dt">row.names =</span> <span class="ot">TRUE</span>,<span class="dt">col.names =</span> <span class="st">&quot;value&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Comparison of estimation and exact value&quot;</span>, <span class="dt">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<caption>Comparison of estimation and exact value</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">estimate</td>
<td align="center">0.4987932</td>
</tr>
<tr class="even">
<td align="left">exact</td>
<td align="center">0.5000000</td>
</tr>
</tbody>
</table>
</div>
<div id="question-5.7" class="section level2">
<h2>Question 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-5.7" class="section level2">
<h2>Answer 5.7</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">library</span>(scales)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#generate random x~u(0,1)</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>n &lt;-<span class="st"> </span><span class="fl">1e5</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co"># simple Monte Carlo method</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>theta1.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(x))</span>
<span id="cb11-9"><a href="#cb11-9"></a>theoreticalValue &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="dv">0</span>)</span>
<span id="cb11-10"><a href="#cb11-10"></a></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#antithetic variate approach</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>y &lt;-<span class="st"> </span>x[<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)]</span>
<span id="cb11-13"><a href="#cb11-13"></a>theta2.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(y)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>y))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb11-14"><a href="#cb11-14"></a></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#estimate two kinds methods&#39; variation</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>var1 &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">exp</span>(x))<span class="op">/</span>n</span>
<span id="cb11-17"><a href="#cb11-17"></a>var2 &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">exp</span>(y)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>y))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb11-18"><a href="#cb11-18"></a>reduction &lt;-<span class="st"> </span><span class="kw">percent</span>((var1<span class="op">-</span>var2)<span class="op">/</span>var1)</span>
<span id="cb11-19"><a href="#cb11-19"></a></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">#create a table to campare</span></span>
<span id="cb11-21"><a href="#cb11-21"></a>z&lt;-<span class="kw">data.frame</span>(<span class="kw">c</span>(theta1.hat,theoreticalValue,var1),<span class="kw">c</span>(theta2.hat,theoreticalValue,var2),<span class="kw">c</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">&quot;</span>,reduction),<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;theta.hat&quot;</span>,<span class="st">&quot;theta&quot;</span>,<span class="st">&quot;variance&quot;</span>))</span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="kw">colnames</span>(z)=<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;simpleMC&quot;</span>,<span class="st">&quot;antithetic&quot;</span>,<span class="st">&quot;redutionPercent&quot;</span>)</span>
<span id="cb11-23"><a href="#cb11-23"></a>knitr<span class="op">::</span><span class="kw">kable</span>(z,<span class="dt">row.names =</span> <span class="ot">TRUE</span>, <span class="dt">caption =</span> <span class="st">&quot;Comparison of two estimations&quot;</span>,<span class="dt">align =</span> <span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<caption>Comparison of two estimations</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">simpleMC</th>
<th align="center">antithetic</th>
<th align="center">redutionPercent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">theta.hat</td>
<td align="center">1.7159790</td>
<td align="center">1.7183542</td>
<td align="center">\</td>
</tr>
<tr class="even">
<td align="left">theta</td>
<td align="center">1.7182818</td>
<td align="center">1.7182818</td>
<td align="center">\</td>
</tr>
<tr class="odd">
<td align="left">variance</td>
<td align="center">0.0000024</td>
<td align="center">0.0000001</td>
<td align="center">97%</td>
</tr>
</tbody>
</table>
</div>
<div id="question-5.11" class="section level2">
<h2>Question 5.11</h2>
<p>If <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>,and <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are antithetic, we derived that <span class="math inline">\(c^{*} =1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_{c}=c\hat{\theta}_{1} +(1 − c)\hat{\theta}_{2}\)</span>.Derive <span class="math inline">\(c^{*}\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^{*}\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_{c}=c\hat{\theta}_{2} +(1 − c)\hat{\theta}_{2}\)</span> in equation.</p>
</div>
<div id="answer-5.11" class="section level2">
<h2>Answer 5.11</h2>
<div id="proof-1" class="section level3">
<h3>proof:</h3>
<p><span class="math display">\[\begin{align*}
\because
&amp;Var(\hat{\theta}_c)\\
=&amp;c^2Var(\hat{\theta}_1)+(1-c)^2Var(\hat{\theta}_2)+2c(1-c)cov(\hat{\theta}_1,\hat{\theta}_2) \\
=&amp;(Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2cov(\hat{\theta}_1,\hat{\theta}_2))c^2-2(Var(\hat{\theta}_2)-cov(\hat{\theta}_1,\hat{\theta}_2))c+Var(\hat{\theta}_2)\\
=&amp;Var(\hat{\theta}_1-\hat{\theta}_2)c^2+2cov(\hat{\theta}_1-\hat{\theta}_2,\hat{\theta}_2)c+Var(\hat{\theta}_2) \\
=&amp;Var(\hat{\theta}_1-\hat{\theta}_2)(c+\frac{cov(\hat{\theta}_{1}-\hat{\theta}_{2},\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)})^{2}-\frac{cov^{2}(\hat{\theta}_1-\hat{\theta}_2,\hat{\theta}_2)}{Var(\hat{\theta}_1-\hat{\theta}_2)}+Var(\hat{\theta}_2)
\end{align*}\]</span></p>
<p><span class="math inline">\(\therefore\)</span>,<span class="math inline">\(c^{*}=-\frac{Cov(\hat{\theta}_{1}-\hat{\theta}_{2},\hat{\theta}_{2})}{Var(\hat{\theta}_{1}-\hat{\theta}_{2})}\)</span></p>
</div>
</div>
</div>
<div id="section-3" class="section level1">
<h1><font color="Teal">2020/10/20</font></h1>
<div id="question-5.1-1" class="section level2">
<h2>Question 5.1</h2>
<p>Find two importance functions <span class="math inline">\(f1\)</span> and <span class="math inline">\(f2\)</span> that are supported on <span class="math inline">\((1, ∞)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},x&gt;1\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\]</span> ## Answer 5.1 {}根据泰勒展开公式，在x=0处展开，<span class="math inline">\(e^{-\frac{x^2}{2}}=1-x^2+3x^4+o(x^4)\)</span><br />
因此我们取最简形式，并且保证<span class="math inline">\(f(x)在(1，\infty)积分为1\)</span><br />
<span class="math inline">\(f1=e^{1-x},f2=\frac{1}{x^2}\)</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb12-2"><a href="#cb12-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e5</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb12-4"><a href="#cb12-4"></a>y &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>x)     </span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#生成服从密度函数为f2的随机数</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb12-8"><a href="#cb12-8"></a>v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)</span>
<span id="cb12-9"><a href="#cb12-9"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x){(x<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)}</span>
<span id="cb12-10"><a href="#cb12-10"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x)}  <span class="co">#设置第一个影响函数</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span>x<span class="op">^</span><span class="dv">2</span>}  <span class="co">#设置第二个影响函数</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>theta1 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(y)<span class="op">/</span><span class="kw">f1</span>(y))</span>
<span id="cb12-13"><a href="#cb12-13"></a>theta2 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(v)<span class="op">/</span><span class="kw">f2</span>(v))</span>
<span id="cb12-14"><a href="#cb12-14"></a>var1 &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">g</span>(y)<span class="op">/</span><span class="kw">f1</span>(y))<span class="op">/</span><span class="kw">length</span>(y)</span>
<span id="cb12-15"><a href="#cb12-15"></a>var2 &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">g</span>(v)<span class="op">/</span><span class="kw">f2</span>(v))<span class="op">/</span><span class="kw">length</span>(u)</span>
<span id="cb12-16"><a href="#cb12-16"></a>z &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb12-17"><a href="#cb12-17"></a></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co">#生成图像比较</span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="kw">plot</span>(z, <span class="kw">g</span>(z)<span class="op">/</span><span class="kw">f1</span>(z), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">3.2</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">main=</span><span class="st">&#39;(ratio of g and f)&#39;</span>)</span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="kw">lines</span>(z,<span class="kw">g</span>(z)<span class="op">/</span><span class="kw">f2</span>(z), <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">expression</span>(f[<span class="dv">1</span>](x)<span class="op">==</span>e<span class="op">^</span>{<span class="op">-</span>x}),<span class="kw">expression</span>(f[<span class="dv">2</span>](x)<span class="op">==</span><span class="dv">4</span><span class="op">/</span>((<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>pi))),<span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">inset =</span> <span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a> <span class="co">#生成表格比较俩种结果</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">c</span>(theta1,var1),<span class="kw">c</span>(theta2,var2),<span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&#39;thetahat&#39;</span>,<span class="st">&#39;thetahat.var&#39;</span>)),<span class="dt">row.names =</span> <span class="ot">TRUE</span>,<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>), <span class="dt">caption =</span> <span class="st">&quot;Comparison of two estimations&quot;</span>, <span class="dt">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<caption>Comparison of two estimations</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">f1</th>
<th align="center">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">thetahat</td>
<td align="center">0.3999808</td>
<td align="center">0.4005856</td>
</tr>
<tr class="even">
<td align="left">thetahat.var</td>
<td align="center">0.0000002</td>
<td align="center">0.0000009</td>
</tr>
</tbody>
</table>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-5.15" class="section level2">
<h2>Answer 5.15</h2>
<p>divide the interval (0,1) into five subintervals, (j/5,(j + 1)/5), j = 0, 1,…, 4.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>r &lt;-<span class="st"> </span>n<span class="op">/</span><span class="dv">5</span>         <span class="co">#replicates per stratum</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>N &lt;-<span class="st"> </span><span class="dv">50</span>          <span class="co">#number of times to repeat the estimation</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a>est &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a>g1&lt;-<span class="cf">function</span>(x){(<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb14-9"><a href="#cb14-9"></a>  y &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,<span class="dt">rate =</span> <span class="dv">1</span>)</span>
<span id="cb14-10"><a href="#cb14-10"></a>  est[j, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g1</span>(y))</span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb14-12"><a href="#cb14-12"></a>    u &lt;-<span class="st"> </span><span class="kw">runif</span>(r)</span>
<span id="cb14-13"><a href="#cb14-13"></a>    v &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(i<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">+</span><span class="kw">exp</span>(<span class="op">-</span>i<span class="op">/</span><span class="dv">5</span>)<span class="op">*</span>u)</span>
<span id="cb14-14"><a href="#cb14-14"></a>    g &lt;-<span class="st"> </span><span class="cf">function</span>(x){((<span class="kw">exp</span>(<span class="op">-</span>(i<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>i<span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(x<span class="op">&gt;</span>(i<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">*</span>(x<span class="op">&lt;</span>i<span class="op">/</span><span class="dv">5</span>)}</span>
<span id="cb14-15"><a href="#cb14-15"></a>    T2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(v))</span>
<span id="cb14-16"><a href="#cb14-16"></a>}</span>
<span id="cb14-17"><a href="#cb14-17"></a>  est[j, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(T2)</span>
<span id="cb14-18"><a href="#cb14-18"></a>}</span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="kw">apply</span>(est,<span class="dv">2</span>,mean)</span></code></pre></div>
<pre><code>## [1] 0.5243391 0.5248387</code></pre>
</div>
<div id="question-6.4" class="section level2">
<h2>Question 6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-6.4" class="section level2">
<h2>Answer 6.4</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>UCL &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>LCL &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#生成计算置信区间的函数</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>CI &lt;-<span class="st"> </span><span class="cf">function</span>(n,alpha){</span>
<span id="cb16-7"><a href="#cb16-7"></a> x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n, <span class="dt">meanlog =</span> <span class="dv">0</span>,<span class="dt">sdlog =</span> <span class="dv">1</span>) </span>
<span id="cb16-8"><a href="#cb16-8"></a> y &lt;-<span class="st"> </span><span class="kw">log</span>(x)</span>
<span id="cb16-9"><a href="#cb16-9"></a> UCL &lt;-<span class="kw">mean</span>(y)<span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(y)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb16-10"><a href="#cb16-10"></a> LCL &lt;-<span class="kw">mean</span>(y)<span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(y)<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb16-11"><a href="#cb16-11"></a> <span class="kw">return</span>(<span class="kw">c</span>(LCL,UCL))</span>
<span id="cb16-12"><a href="#cb16-12"></a>}</span>
<span id="cb16-13"><a href="#cb16-13"></a></span>
<span id="cb16-14"><a href="#cb16-14"></a>k &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="kw">CI</span>(<span class="dv">20</span>,<span class="fl">0.05</span>))</span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="kw">sum</span>((k[<span class="dv">1</span>,]<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">*</span>(k[<span class="dv">2</span>,]<span class="op">&gt;</span><span class="dv">0</span>))<span class="op">/</span><span class="dv">1000</span></span></code></pre></div>
<pre><code>## [1] 0.96</code></pre>
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2\)</span>(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-6.5" class="section level2">
<h2>Answer 6.5</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>UCL &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>LCL &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#生成计算置信区间的函数</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>CI &lt;-<span class="st"> </span><span class="cf">function</span>(n,alpha){</span>
<span id="cb18-7"><a href="#cb18-7"></a> x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>) </span>
<span id="cb18-8"><a href="#cb18-8"></a> UCL &lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb18-9"><a href="#cb18-9"></a> LCL &lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb18-10"><a href="#cb18-10"></a> <span class="kw">return</span>(<span class="kw">c</span>(LCL,UCL))</span>
<span id="cb18-11"><a href="#cb18-11"></a>}</span>
<span id="cb18-12"><a href="#cb18-12"></a></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#x服从自由度为2的卡方分布，E(x)=2</span></span>
<span id="cb18-14"><a href="#cb18-14"></a>k &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="kw">CI</span>(<span class="dv">20</span>,<span class="fl">0.05</span>))</span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="kw">sum</span>((k[<span class="dv">1</span>,]<span class="op">&lt;</span><span class="dv">2</span>)<span class="op">*</span>(k[<span class="dv">2</span>,]<span class="op">&gt;</span><span class="dv">2</span>))<span class="op">/</span><span class="dv">1000</span></span></code></pre></div>
<pre><code>## [1] 0.919</code></pre>
</div>
</div>
<div id="section-4" class="section level1">
<h1><font color="Teal">2020/10/27</font></h1>
<div id="question-6.7" class="section level2">
<h2>Question 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta<span class="math inline">\((\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(ν)\)</span>?</p>
</div>
<div id="answer-6.7" class="section level2">
<h2>Answer 6.7</h2>
<p>{}We estimate by simulation the power of the skewness test of beta distribution against a contaminated beta alternative.The contaminated beta distribution is denoted by <span class="math inline">\((1-t)\beta(2,2)+t\beta(10,10)\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co">#pure distribution</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>alpha &lt;-<span class="fl">0.05</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#creat a function to compute the sample skewness statistic.</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb20-5"><a href="#cb20-5"></a>xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb20-6"><a href="#cb20-6"></a>m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb20-7"><a href="#cb20-7"></a>m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="kw">return</span>(m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb20-9"><a href="#cb20-9"></a>}</span>
<span id="cb20-10"><a href="#cb20-10"></a>n &lt;-<span class="st"> </span><span class="dv">40</span></span>
<span id="cb20-11"><a href="#cb20-11"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb20-12"><a href="#cb20-12"></a>m &lt;-<span class="st"> </span><span class="dv">4000</span></span>
<span id="cb20-13"><a href="#cb20-13"></a>t &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb20-14"><a href="#cb20-14"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(t)</span>
<span id="cb20-15"><a href="#cb20-15"></a>test1 &lt;-<span class="st"> </span>test2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb20-16"><a href="#cb20-16"></a>a &lt;-<span class="st"> </span>b &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb20-17"><a href="#cb20-17"></a>POWER &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb20-19"><a href="#cb20-19"></a>  p &lt;-<span class="st"> </span>t[i]</span>
<span id="cb20-20"><a href="#cb20-20"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb20-21"><a href="#cb20-21"></a>    a &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p,p))</span>
<span id="cb20-22"><a href="#cb20-22"></a>    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,a,a)</span>
<span id="cb20-23"><a href="#cb20-23"></a>    test1[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)     <span class="co">#mixed beta distribution</span></span>
<span id="cb20-24"><a href="#cb20-24"></a>    b &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p,p))</span>
<span id="cb20-25"><a href="#cb20-25"></a>    y &lt;-<span class="st"> </span><span class="kw">rt</span>(n,<span class="dt">df=</span>b)</span>
<span id="cb20-26"><a href="#cb20-26"></a>    test2[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(y)) <span class="op">&gt;=</span><span class="st"> </span>cv)    <span class="co">#mixed t distribution</span></span>
<span id="cb20-27"><a href="#cb20-27"></a>  }</span>
<span id="cb20-28"><a href="#cb20-28"></a>  POWER[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(test1)</span>
<span id="cb20-29"><a href="#cb20-29"></a>  POWER[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(test2)</span>
<span id="cb20-30"><a href="#cb20-30"></a>}             </span>
<span id="cb20-31"><a href="#cb20-31"></a><span class="co"># graph to compare</span></span>
<span id="cb20-32"><a href="#cb20-32"></a><span class="kw">plot</span>(t, POWER[,<span class="dv">1</span>], <span class="dt">xlab =</span> <span class="kw">bquote</span>(t), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb20-33"><a href="#cb20-33"></a><span class="kw">lines</span>(t,POWER[,<span class="dv">2</span>],<span class="dt">xlab =</span> <span class="kw">bquote</span>(t),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="dv">3</span>,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb20-34"><a href="#cb20-34"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;beta ditribution&quot;</span>,<span class="st">&quot;t distribution&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-6.8" class="section level2">
<h2>Question 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat\alpha\)</span> = 0.055. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-6.8" class="section level2">
<h2>Answer 6.8</h2>
<p>{}</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>k &lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb21-3"><a href="#cb21-3"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb21-4"><a href="#cb21-4"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb21-5"><a href="#cb21-5"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb21-6"><a href="#cb21-6"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb21-8"><a href="#cb21-8"></a>}</span>
<span id="cb21-9"><a href="#cb21-9"></a></span>
<span id="cb21-10"><a href="#cb21-10"></a>power &lt;-<span class="st"> </span><span class="cf">function</span>(n,alpha){</span>
<span id="cb21-11"><a href="#cb21-11"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb21-12"><a href="#cb21-12"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb21-13"><a href="#cb21-13"></a>  pow1 &lt;-<span class="st"> </span><span class="kw">count5test</span>(x, y)</span>
<span id="cb21-14"><a href="#cb21-14"></a>  pow2 &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">var.test</span>(x,y,<span class="dt">ratio =</span> <span class="dv">1</span>,<span class="dt">conf.level =</span> <span class="dv">1</span><span class="op">-</span>alpha)<span class="op">$</span>p.value <span class="op">&lt;</span><span class="st"> </span>alpha)</span>
<span id="cb21-15"><a href="#cb21-15"></a>  <span class="kw">return</span>(<span class="kw">c</span>(pow1,pow2))</span>
<span id="cb21-16"><a href="#cb21-16"></a>}</span>
<span id="cb21-17"><a href="#cb21-17"></a></span>
<span id="cb21-18"><a href="#cb21-18"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb21-19"><a href="#cb21-19"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb21-20"><a href="#cb21-20"></a>sigma2 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb21-21"><a href="#cb21-21"></a>alpha  &lt;-<span class="st"> </span><span class="fl">0.055</span></span>
<span id="cb21-22"><a href="#cb21-22"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb21-23"><a href="#cb21-23"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb21-24"><a href="#cb21-24"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb21-25"><a href="#cb21-25"></a>  k[,i] &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">replicate</span>(m,<span class="kw">power</span>(n[i],alpha)),<span class="dt">MARGIN =</span> <span class="dv">1</span>,mean)</span>
<span id="cb21-26"><a href="#cb21-26"></a>}</span>
<span id="cb21-27"><a href="#cb21-27"></a>result &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(k,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;count five test&quot;</span>,<span class="st">&quot;F test&quot;</span>))</span>
<span id="cb21-28"><a href="#cb21-28"></a><span class="kw">colnames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;small&quot;</span>,<span class="st">&quot;medium&quot;</span>,<span class="st">&quot;large&quot;</span>)</span>
<span id="cb21-29"><a href="#cb21-29"></a><span class="kw">print</span>(result)</span></code></pre></div>
<pre><code>##                 small medium large
## count five test 0.683  0.998     1
## F test          0.842  1.000     1</code></pre>
</div>
<div id="question-6.c" class="section level2">
<h2>Question 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X and Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math inline">\(\beta_{1,d}=E[X-\mu]^T\sum^{-1}(Y-\mu)]^3\)</span><br />
Under normality, β1,d = 0. The multivariate skewness statistic is<br />
<span class="math inline">\(b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n((X-\mu)^T\hat\sum^{-1}(X_j-\bar X))^3\)</span>, where <span class="math inline">\(\hat\sum\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-6.c" class="section level2">
<h2>Answer 6.C</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">#对于n*d维矩阵x，(x1,x2....xn),每个样本含有d个变量,s为协方差矩阵</span></span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a>b_1d &lt;-<span class="st"> </span><span class="cf">function</span>(x,d){</span>
<span id="cb23-4"><a href="#cb23-4"></a>  xbar &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dt">margin=</span><span class="dv">1</span>, mean)</span>
<span id="cb23-5"><a href="#cb23-5"></a>   y &lt;-<span class="st"> </span>x<span class="op">-</span>xbar</span>
<span id="cb23-6"><a href="#cb23-6"></a>   s &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">cov</span>(x))</span>
<span id="cb23-7"><a href="#cb23-7"></a>   b_1d &lt;-<span class="st"> </span>(<span class="kw">t</span>(y)<span class="op">%*%</span>s<span class="op">%*%</span>y)<span class="op">^</span><span class="dv">3</span><span class="op">/</span>n<span class="op">^</span><span class="dv">2</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>}</span></code></pre></div>
</div>
<div id="question-discussion" class="section level2">
<h2>Question discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>{}:1.What is the corresponding hypothesis test problem?</p>
<p><span class="math inline">\(H_0:power_1 = power_2 \qquad H_1:power_1 \ne power_2\)</span></p>
<p>2.What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p>Beacause we obtain the powers for two methods under a particular simulation setting with 10,000 experiments,which is based on the data of homologous pairing, we can use Z-test, paired-t test and McNemar test except two-sample t-test.Under the premise of a large sample,we’d better choose Z-test and McNemar test.Under the premise of a small sample,paired-t test is more suitable.</p>
<p>3.What information is needed to test your hypothesis? the powers for two methods under a particular simulation setting with 10,000 experiments</p>
</div>
</div>
<div id="section-5" class="section level1">
<h1><font color="Teal">2020/11/03</font></h1>
<div id="question-9.4" class="section level2">
<h2>Question 9.4</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-9.4" class="section level2">
<h2>Answer 9.4</h2>
<p>{}</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb24-2"><a href="#cb24-2"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb24-3"><a href="#cb24-3"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb24-4"><a href="#cb24-4"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb24-5"><a href="#cb24-5"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</span>
<span id="cb24-7"><a href="#cb24-7"></a>}</span></code></pre></div>
</div>
<div id="question-7.5" class="section level2">
<h2>Question 7.5</h2>
</div>
<div id="answer-7.5" class="section level2">
<h2>Answer 7.5</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>m&lt;-<span class="fl">1e3</span> <span class="co">#number of cycles</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>B&lt;-<span class="fl">1e3</span> <span class="co">#The number of bootstrap replicates</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="kw">library</span>(boot)<span class="co">#for boot and boot.ci function</span></span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co">#generates 4 different types of equi-tailed two-sided nonparametric confidence intervals</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb28-3"><a href="#cb28-3"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>aircondit,<span class="dt">statistic=</span><span class="cf">function</span>(x,i){<span class="kw">mean</span>(x[i,])}, <span class="dt">R=</span>B )</span>
<span id="cb28-4"><a href="#cb28-4"></a>  CI &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(boot.obj,<span class="dt">conf=</span><span class="fl">0.95</span>,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb28-5"><a href="#cb28-5"></a></span>
<span id="cb28-6"><a href="#cb28-6"></a>}</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="kw">print</span>(CI)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, conf = 0.95, type = c(&quot;norm&quot;, &quot;basic&quot;, 
##     &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.5, 183.5 )   ( 24.9, 172.2 )  
## 
## Level     Percentile            BCa          
## 95%   ( 43.9, 191.2 )   ( 54.3, 221.9 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
</div>
<div id="section-6" class="section level1">
<h1><font color="Teal">2020/11/10</font></h1>
<div id="question-8.3" class="section level2">
<h2>Question 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-8.3" class="section level2">
<h2>Answer 8.3</h2>
<p>{}</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>vartest &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb30-2"><a href="#cb30-2"></a>x0 &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb30-3"><a href="#cb30-3"></a>y0 &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb30-4"><a href="#cb30-4"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(x0 <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(y0)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x0 <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(y0))</span>
<span id="cb30-5"><a href="#cb30-5"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(y0 <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(x0)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y0 <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(x0))</span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</span>
<span id="cb30-7"><a href="#cb30-7"></a>}</span>
<span id="cb30-8"><a href="#cb30-8"></a></span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb30-10"><a href="#cb30-10"></a>R &lt;-<span class="st"> </span><span class="dv">999</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb30-12"><a href="#cb30-12"></a>n2 &lt;-<span class="st"> </span><span class="dv">40</span></span>
<span id="cb30-13"><a href="#cb30-13"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2  </span>
<span id="cb30-14"><a href="#cb30-14"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb30-15"><a href="#cb30-15"></a>p &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb30-16"><a href="#cb30-16"></a>p.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb30-17"><a href="#cb30-17"></a>test &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr =</span> {</span>
<span id="cb30-18"><a href="#cb30-18"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb30-19"><a href="#cb30-19"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb30-20"><a href="#cb30-20"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb30-21"><a href="#cb30-21"></a>temp &lt;-<span class="st"> </span><span class="kw">vartest</span>(x,y)</span>
<span id="cb30-22"><a href="#cb30-22"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</span>
<span id="cb30-23"><a href="#cb30-23"></a>ind &lt;-<span class="st"> </span><span class="kw">sample</span>(n, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb30-24"><a href="#cb30-24"></a>x1 &lt;-<span class="st"> </span>z[ind]</span>
<span id="cb30-25"><a href="#cb30-25"></a>y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>ind] </span>
<span id="cb30-26"><a href="#cb30-26"></a>p[i] &lt;-<span class="kw">vartest</span>(x1, y1)</span>
<span id="cb30-27"><a href="#cb30-27"></a>}</span>
<span id="cb30-28"><a href="#cb30-28"></a>p.hat &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">+</span><span class="kw">sum</span>(<span class="kw">as.integer</span>(p<span class="op">&gt;</span>temp)))<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb30-29"><a href="#cb30-29"></a>})</span>
<span id="cb30-30"><a href="#cb30-30"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">mean</span>(test),<span class="dv">6</span>))</span></code></pre></div>
<pre><code>## [1] 0.417593</code></pre>
<p>analysis: Pvalue平均值为0.417，大于0.05，因此没有充分理由拒绝原假设，所以两样本为同分布。</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations. 1.Unequal variances and equal expectations 2.Unequal variances and unequal expectations 3.Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) 4.Unbalanced samples (say, 1 case versus 10 controls) Note: The parameters should be chosen such that the power are distinguishable (say, range from 0.3 to 0.8).</p>
<p>analysis: 1.For the first situation, we set sample with <span class="math inline">\(X \sim N(0,1),Y \sim N(0,4)\)</span> 2.For the second situation, we set sample with <span class="math inline">\(X \sim N(0,1),Y \sim N(1,4)\)</span> 3.For the third situation, we set sample with <span class="math inline">\(X \sim t(1)\)</span>,the bimodel distribution is devoted by <span class="math inline">\((1-\epsilon)N(0,1)+\epsilon N(1,4)\)</span> 4.For the fourth situation, we set n1 = 20,n2 = 100. ## Answer 2</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">library</span>(RANN)  <span class="co">#for NN test</span></span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">library</span>(energy) <span class="co">#for energy test</span></span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">library</span>(Ball)  <span class="co">#for ball test</span></span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb38-2"><a href="#cb38-2"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {                  </span>
<span id="cb38-3"><a href="#cb38-3"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb38-5"><a href="#cb38-5"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb38-6"><a href="#cb38-6"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb38-7"><a href="#cb38-7"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb38-8"><a href="#cb38-8"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb38-9"><a href="#cb38-9"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb38-10"><a href="#cb38-10"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb38-11"><a href="#cb38-11"></a>}</span>
<span id="cb38-12"><a href="#cb38-12"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb38-13"><a href="#cb38-13"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb38-14"><a href="#cb38-14"></a>  <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb38-15"><a href="#cb38-15"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb38-16"><a href="#cb38-16"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb38-17"><a href="#cb38-17"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb38-18"><a href="#cb38-18"></a>}</span>
<span id="cb38-19"><a href="#cb38-19"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb38-20"><a href="#cb38-20"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb38-21"><a href="#cb38-21"></a></span>
<span id="cb38-22"><a href="#cb38-22"></a></span>
<span id="cb38-23"><a href="#cb38-23"></a></span>
<span id="cb38-24"><a href="#cb38-24"></a></span>
<span id="cb38-25"><a href="#cb38-25"></a><span class="co">#Unequal variances and equal expectations</span></span>
<span id="cb38-26"><a href="#cb38-26"></a>k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb38-27"><a href="#cb38-27"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb38-28"><a href="#cb38-28"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb38-29"><a href="#cb38-29"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb38-30"><a href="#cb38-30"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb38-31"><a href="#cb38-31"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb38-32"><a href="#cb38-32"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb38-33"><a href="#cb38-33"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb38-34"><a href="#cb38-34"></a>}</span>
<span id="cb38-35"><a href="#cb38-35"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb38-36"><a href="#cb38-36"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb38-37"><a href="#cb38-37"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb38-38"><a href="#cb38-38"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb38-39"><a href="#cb38-39"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb38-40"><a href="#cb38-40"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb38-41"><a href="#cb38-41"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb38-42"><a href="#cb38-42"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb38-43"><a href="#cb38-43"></a>}</span>
<span id="cb38-44"><a href="#cb38-44"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>                        <span class="co">#confidence level </span></span>
<span id="cb38-45"><a href="#cb38-45"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb38-46"><a href="#cb38-46"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.455 0.470 0.878</code></pre>
<p>analysis: from the result(Unequal variances and equal expectations),for the first situation,the ball test get the highest power.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co">#Unequal variances and unequal expectations</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb40-3"><a href="#cb40-3"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb40-5"><a href="#cb40-5"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb40-6"><a href="#cb40-6"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb40-8"><a href="#cb40-8"></a>}</span>
<span id="cb40-9"><a href="#cb40-9"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb40-10"><a href="#cb40-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb40-11"><a href="#cb40-11"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb40-12"><a href="#cb40-12"></a>y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb40-13"><a href="#cb40-13"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb40-14"><a href="#cb40-14"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb40-15"><a href="#cb40-15"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb40-16"><a href="#cb40-16"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb40-17"><a href="#cb40-17"></a>}</span>
<span id="cb40-18"><a href="#cb40-18"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>                        <span class="co">#confidence level </span></span>
<span id="cb40-19"><a href="#cb40-19"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb40-20"><a href="#cb40-20"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.772 0.936 0.975</code></pre>
<p>analysis: from the result,for the second situation(Unequal variances and unequal expectations),the ball test get the highest power.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co">#Non-normal distributions</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb42-3"><a href="#cb42-3"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb42-4"><a href="#cb42-4"></a>y &lt;-<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>),<span class="kw">rnorm</span>(n2,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb42-5"><a href="#cb42-5"></a>z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb42-6"><a href="#cb42-6"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value<span class="co">#performance of NN method</span></span>
<span id="cb42-7"><a href="#cb42-7"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value<span class="co">#performance of energy method</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value<span class="co">#performance of ball method</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>}</span>
<span id="cb42-10"><a href="#cb42-10"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>                        <span class="co">#confidence level </span></span>
<span id="cb42-11"><a href="#cb42-11"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb42-12"><a href="#cb42-12"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.340 0.531 0.510</code></pre>
<p>analysis: from the result,for the third situation(Non-normal distributions),the energy test get the highest power.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co">#Unbalanced samples</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>n1&lt;-<span class="dv">20</span>;n2&lt;-<span class="dv">100</span>;N=<span class="kw">c</span>(n1,n2)</span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb44-4"><a href="#cb44-4"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb44-5"><a href="#cb44-5"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb44-6"><a href="#cb44-6"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb44-7"><a href="#cb44-7"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value<span class="co">#performance of NN method</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value<span class="co">#performance of energy method</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value<span class="co">#performance of ball method</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>}</span>
<span id="cb44-11"><a href="#cb44-11"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>                        <span class="co">#confidence level </span></span>
<span id="cb44-12"><a href="#cb44-12"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb44-13"><a href="#cb44-13"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.623 0.932 0.674</code></pre>
<p>analysis: from the result,for the fourth situation(Unbalanced samples),the energy test get the highest power.</p>
</div>
</div>
<div id="section-7" class="section level1">
<h1><font color="Teal">2020/11/17</font></h1>
<div id="question-9.4-1" class="section level2">
<h2>Question 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain. analysis: Target distribution: <span class="math inline">\(t_{\nu}\)</span>Laplace distribution:<span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span> Proposal distribution: <span class="math inline">\(N(X_t,\sigma^2)\)</span> Number of rejection (per 2000)</p>
</div>
<div id="answer-9.4-1" class="section level2">
<h2>Answer 9.4</h2>
<p>{}</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a>Ld &lt;-<span class="cf">function</span>(x){<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))<span class="op">/</span><span class="dv">2</span>}</span>
<span id="cb46-4"><a href="#cb46-4"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb46-5"><a href="#cb46-5"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb46-6"><a href="#cb46-6"></a>x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb46-7"><a href="#cb46-7"></a>        u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb46-8"><a href="#cb46-8"></a>        k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb46-10"><a href="#cb46-10"></a>            y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb46-11"><a href="#cb46-11"></a>                <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">Ld</span>(y)<span class="op">/</span><span class="st"> </span><span class="kw">Ld</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb46-12"><a href="#cb46-12"></a>                    x[i] &lt;-<span class="st"> </span>y  </span>
<span id="cb46-13"><a href="#cb46-13"></a>                <span class="cf">else</span> {</span>
<span id="cb46-14"><a href="#cb46-14"></a>                    x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb46-15"><a href="#cb46-15"></a>                    k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb46-16"><a href="#cb46-16"></a>                }</span>
<span id="cb46-17"><a href="#cb46-17"></a>            }</span>
<span id="cb46-18"><a href="#cb46-18"></a>        <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb46-19"><a href="#cb46-19"></a>    }</span>
<span id="cb46-20"><a href="#cb46-20"></a></span>
<span id="cb46-21"><a href="#cb46-21"></a>    N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb46-22"><a href="#cb46-22"></a>    sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>,<span class="dv">2</span>,<span class="dv">16</span>)</span>
<span id="cb46-23"><a href="#cb46-23"></a></span>
<span id="cb46-24"><a href="#cb46-24"></a>    x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb46-25"><a href="#cb46-25"></a>    rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb46-26"><a href="#cb46-26"></a>    rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb46-27"><a href="#cb46-27"></a>    rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb46-28"><a href="#cb46-28"></a>    rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb46-29"><a href="#cb46-29"></a>    </span>
<span id="cb46-30"><a href="#cb46-30"></a></span>
<span id="cb46-31"><a href="#cb46-31"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb46-32"><a href="#cb46-32"></a>no.reject &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">no.reject=</span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</span>
<span id="cb46-33"><a href="#cb46-33"></a>knitr<span class="op">::</span><span class="kw">kable</span>(no.reject,<span class="dt">format=</span><span class="st">&#39;latex&#39;</span>,<span class="dt">caption =</span> <span class="st">&quot;Number of rejection per 2000&quot;</span>)</span></code></pre></div>

<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">matrix</span>(<span class="kw">c</span>(no.reject[,<span class="dv">1</span>],<span class="dv">1</span><span class="op">-</span>no.reject[,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2000</span>),<span class="dt">ncol =</span> <span class="dv">2</span>,<span class="dt">nrow=</span><span class="dv">4</span>,<span class="dt">byrow=</span><span class="ot">FALSE</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="kw">c</span>(<span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;acceptance rates&quot;</span>)))</span></code></pre></div>
<pre><code>##   sigma acceptance rates
## 1  0.05           0.9825
## 2  0.50           0.8300
## 3  2.00           0.5210
## 4 16.00           0.1085</code></pre>
<p>display 4 graphs together with different sigma.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))  </span>
<span id="cb49-2"><a href="#cb49-2"></a>rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span>))</span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">log</span>(<span class="dv">2</span>))</span>
<span id="cb49-9"><a href="#cb49-9"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#reset to default</span></span></code></pre></div>
<p>analysis:among the four chains,in the third plot (σ = 2) the chain is mixing well and converging to the target distribution after a short burn-in period. The fourth chain converges, but it is inefficient.so in the third plot (σ = 2) the chain perform the best.</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt;1.2\)</span>.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb51-4"><a href="#cb51-4"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb51-5"><a href="#cb51-5"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb51-6"><a href="#cb51-6"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb51-7"><a href="#cb51-7"></a></span>
<span id="cb51-8"><a href="#cb51-8"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb51-9"><a href="#cb51-9"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb51-10"><a href="#cb51-10"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb51-11"><a href="#cb51-11"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb51-12"><a href="#cb51-12"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb51-13"><a href="#cb51-13"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span></span>
<span id="cb51-14"><a href="#cb51-14"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb51-15"><a href="#cb51-15"></a>}</span>
<span id="cb51-16"><a href="#cb51-16"></a></span>
<span id="cb51-17"><a href="#cb51-17"></a>Ld.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb51-18"><a href="#cb51-18"></a>        <span class="co">#generates a Metropolis chain for Normal(0,1)</span></span>
<span id="cb51-19"><a href="#cb51-19"></a>        <span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb51-20"><a href="#cb51-20"></a>        <span class="co">#and starting value X1</span></span>
<span id="cb51-21"><a href="#cb51-21"></a>        x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb51-22"><a href="#cb51-22"></a>        x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb51-23"><a href="#cb51-23"></a>        u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb51-24"><a href="#cb51-24"></a></span>
<span id="cb51-25"><a href="#cb51-25"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb51-26"><a href="#cb51-26"></a>            xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb51-27"><a href="#cb51-27"></a>            y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, xt, sigma)     <span class="co">#candidate point</span></span>
<span id="cb51-28"><a href="#cb51-28"></a>            <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">Ld</span>(y)<span class="op">/</span><span class="kw">Ld</span>(xt))) x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb51-29"><a href="#cb51-29"></a>            <span class="cf">else</span>  x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb51-30"><a href="#cb51-30"></a>            }</span>
<span id="cb51-31"><a href="#cb51-31"></a>        <span class="kw">return</span>(x)</span>
<span id="cb51-32"><a href="#cb51-32"></a>}</span>
<span id="cb51-33"><a href="#cb51-33"></a></span>
<span id="cb51-34"><a href="#cb51-34"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span>     <span class="co">#parameter of proposal distribution</span></span>
<span id="cb51-35"><a href="#cb51-35"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb51-36"><a href="#cb51-36"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span>      <span class="co">#length of chains</span></span>
<span id="cb51-37"><a href="#cb51-37"></a>b &lt;-<span class="st"> </span><span class="dv">500</span>       <span class="co">#burn-in length</span></span>
<span id="cb51-38"><a href="#cb51-38"></a></span>
<span id="cb51-39"><a href="#cb51-39"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb51-40"><a href="#cb51-40"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb51-41"><a href="#cb51-41"></a></span>
<span id="cb51-42"><a href="#cb51-42"></a><span class="co">#generate the chains</span></span>
<span id="cb51-43"><a href="#cb51-43"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb51-44"><a href="#cb51-44"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb51-45"><a href="#cb51-45"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb51-46"><a href="#cb51-46"></a>X[i, ] &lt;-<span class="st"> </span><span class="kw">Ld.chain</span>(sigma,n,x0[i])</span>
<span id="cb51-47"><a href="#cb51-47"></a>}</span>
<span id="cb51-48"><a href="#cb51-48"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb51-49"><a href="#cb51-49"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb51-50"><a href="#cb51-50"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb51-51"><a href="#cb51-51"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb51-52"><a href="#cb51-52"></a></span>
<span id="cb51-53"><a href="#cb51-53"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb51-54"><a href="#cb51-54"></a><span class="co"># par(mfrow=c(2,2))for (i in 1:k)</span></span>
<span id="cb51-55"><a href="#cb51-55"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb51-56"><a href="#cb51-56"></a> <span class="cf">if</span>(i<span class="op">==</span><span class="dv">1</span>){</span>
<span id="cb51-57"><a href="#cb51-57"></a>        <span class="kw">plot</span>((b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n],<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">0.2</span>), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb51-58"><a href="#cb51-58"></a>            <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</span>
<span id="cb51-59"><a href="#cb51-59"></a>      }<span class="cf">else</span>{</span>
<span id="cb51-60"><a href="#cb51-60"></a>        <span class="kw">lines</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">col=</span>i)</span>
<span id="cb51-61"><a href="#cb51-61"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-11.4" class="section level2">
<h2>Question 11.4</h2>
<p>Find the intersection points A(k) in <span class="math inline">\((0, \sqrt k)\)</span> of the curves<br />
<span class="math inline">\(S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})\)</span><br />
and <span class="math inline">\(S_{k}(a)=P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}})\)</span>, for k = 4 : 25, 100, 500, 1000, where <span class="math inline">\(t(k)\)</span> is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(a){</span>
<span id="cb53-3"><a href="#cb53-3"></a>  s1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="dt">df=</span>k)</span>
<span id="cb53-4"><a href="#cb53-4"></a>  s2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="dt">df=</span>k<span class="dv">-1</span>)</span>
<span id="cb53-5"><a href="#cb53-5"></a>  s &lt;-<span class="st"> </span>s1<span class="op">-</span>s2</span>
<span id="cb53-6"><a href="#cb53-6"></a>  <span class="kw">return</span>(s)</span>
<span id="cb53-7"><a href="#cb53-7"></a>}</span>
<span id="cb53-8"><a href="#cb53-8"></a>e &lt;-<span class="st"> </span><span class="fl">1e-6</span></span>
<span id="cb53-9"><a href="#cb53-9"></a>root &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">25</span>)</span>
<span id="cb53-10"><a href="#cb53-10"></a>f.root &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">25</span>)</span>
<span id="cb53-11"><a href="#cb53-11"></a>h &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">25</span>)</span>
<span id="cb53-12"><a href="#cb53-12"></a>x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb53-13"><a href="#cb53-13"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>) {</span>
<span id="cb53-14"><a href="#cb53-14"></a>  h[i] &lt;-<span class="st"> </span>b[i]</span>
<span id="cb53-15"><a href="#cb53-15"></a>  k=h[i]</span>
<span id="cb53-16"><a href="#cb53-16"></a>  root[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="dv">0</span><span class="op">+</span>e,h[i]<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">-</span>e))<span class="op">$</span>root</span>
<span id="cb53-17"><a href="#cb53-17"></a>  f.root[i] <span class="op">&lt;</span><span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="dv">0</span><span class="op">+</span>e,h[i]<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">-</span>e))<span class="op">$</span>f.root</span>
<span id="cb53-18"><a href="#cb53-18"></a>}</span>
<span id="cb53-19"><a href="#cb53-19"></a>x &lt;-<span class="st"> </span><span class="kw">cbind</span>(h,root,f.root)</span>
<span id="cb53-20"><a href="#cb53-20"></a>knitr<span class="op">::</span><span class="kw">kable</span>(x,<span class="dt">col.names=</span><span class="kw">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;root&quot;</span>,<span class="st">&quot;f.root&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">root</th>
<th align="right">f.root</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492103</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.533548</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.562768</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584421</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601182</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.614517</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625406</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634409</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642026</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.648511</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654174</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659121</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663442</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667288</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.670736</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.673841</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.676589</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679139</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681461</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">4.795831</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">4.898979</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">4.999999</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">9.999999</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">22.360679</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">31.622776</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-8" class="section level1">
<h1><font color="Teal">2020/11/24</font></h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<ul>
<li>A-B-O blood type problem
<ul>
<li>Let the three alleles be A, B, and O.</li>
</ul></li>
</ul>
<table>
<thead>
<tr class="header">
<th>Genotype</th>
<th>AA</th>
<th>BB</th>
<th>OO</th>
<th>AO</th>
<th>BO</th>
<th>AB</th>
<th>Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frequency</td>
<td>p2</td>
<td>q2</td>
<td>r2</td>
<td>2pr</td>
<td>2qr</td>
<td>2pq</td>
<td>1</td>
</tr>
<tr class="even">
<td>Count</td>
<td>nAA</td>
<td>nBB</td>
<td>nOO</td>
<td>nAO</td>
<td>nBO</td>
<td>nAB</td>
<td>n</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Observed data: <span class="math inline">\(n_{A\cdot}=n_{AA}+n_{AO}=444\)</span>(A-type), <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=132\)</span>(B-type), <span class="math inline">\(n_{OO}=361\)</span>(O-type), <span class="math inline">\(n_{AB}=63\)</span>(AB-type).</p></li>
<li><p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span>and <span class="math inline">\(q\)</span>(consider missing data <span class="math inline">\(n_{AA}\)</span>and <span class="math inline">\(n_{BB}\)</span>).</p></li>
<li><p>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p></li>
</ul>
<p>analysis: we use <span class="math inline">\(n_A\)</span> to represent <span class="math inline">\(n_{A\cdot}\)</span>,<span class="math inline">\(n_B\)</span> to represent <span class="math inline">\(n_{B\cdot}\)</span>，and <span class="math inline">\(n_O\)</span> to represent $n_{OO} 1、observed data likelihood: <span class="math display">\[L(p,q|n_A,n_B,n_O,n_{AB})=(p^2+2pr)^{n_A}(q^2+2qr)^{n_B}(r^2)^{n_O}(2pq)^{n_{AB}}\]</span> where, r=1-p-q then,find the optimal solution <span class="math inline">\(p_0\)</span>,<span class="math inline">\(q_0\)</span> by taking the derivative <span class="math display">\[L(p|n_A,n_B,n_O,n_{AB})=(p^2+2pr)^{n_A}(q^2+2qr)^{n_B}(r^2)^{n_O}(2pq)^{n_{AB}}\]</span></p>
<p>2、complete data likelihood <span class="math display">\[L(p,q|n_{AA},n_{AO},n_{BB},n_{BO},n_O,n_{AB})=(p^2)^{n_{AA}}(2pr)^{n_{AO}}(q^2)^{n_{BB}}(2qr)^{n_{BO}}(r^2)^{n_O}(2pq)^{n_{AB}}\]</span><br />
<span class="math display">\[l(p|n_{AA},n_A,n_{BB},n_B,n_O,n_{AB})=n_{AA}log(\frac{p}{2r})+n_Alog(2pr)+n_{BB}log(\frac{q}{2r})+n_Blog(2qr)+2n_Olog(r)+n_{AB}log(2pq)\]</span> where,<span class="math inline">\(r=1-p-q\)</span></p>
<p>3、E-step <span class="math display">\[E_{\hat p_0,\hat q_0}[l(p,q|n_{AA},n_A,n_{BB},n_B,n_O,n_{AB})]=\frac{p}{p+2r}n_Alog(\frac{p}{2r})+n_Alog(2pr)+\frac{q}{q+2r}n_Blog(\frac{q}{2r})+n_Blog(2qr)+2n_Olog(r)+n_{AB}log(2pq)\]</span> <span class="math inline">\(n_{AA}|n_A,n_B,n_O,n_{AB} \sim B(n_{A},\frac{p}{p+2r})\)</span> <span class="math inline">\(n_{BB}|n_B,n_A,n_O,n_{AB} \sim B(n_{B},\frac{q}{q+2r})\)</span></p>
<p>4、iterate p,q until they converge to fixed values.</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<p>解：</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">library</span>(<span class="st">&quot;knitr&quot;</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a>nA &lt;-<span class="st"> </span><span class="dv">444</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>nB &lt;-<span class="st"> </span><span class="dv">132</span></span>
<span id="cb54-4"><a href="#cb54-4"></a>nO &lt;-<span class="st"> </span><span class="dv">361</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>nAB &lt;-<span class="st"> </span><span class="dv">63</span></span>
<span id="cb54-6"><a href="#cb54-6"></a>n &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">c</span>(nA,nB,nO,nAB))</span>
<span id="cb54-7"><a href="#cb54-7"></a>pqr &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">3</span>)</span>
<span id="cb54-8"><a href="#cb54-8"></a>pql &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">3</span>)</span>
<span id="cb54-9"><a href="#cb54-9"></a>ll &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb54-10"><a href="#cb54-10"></a></span>
<span id="cb54-11"><a href="#cb54-11"></a><span class="co">#estimate initial p0,q0,r0</span></span>
<span id="cb54-12"><a href="#cb54-12"></a>l &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb54-13"><a href="#cb54-13"></a>  p &lt;-<span class="st"> </span>x[<span class="dv">1</span>]</span>
<span id="cb54-14"><a href="#cb54-14"></a>  q &lt;-<span class="st"> </span>x[<span class="dv">2</span>]</span>
<span id="cb54-15"><a href="#cb54-15"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb54-16"><a href="#cb54-16"></a>  <span class="op">-</span>(nA<span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>nB<span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>nO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span><span class="st"> </span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q))</span>
<span id="cb54-17"><a href="#cb54-17"></a>}</span>
<span id="cb54-18"><a href="#cb54-18"></a>pq &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.1</span>),l,<span class="dt">method =</span> <span class="st">&quot;CG&quot;</span>)<span class="op">$</span>par</span></code></pre></div>
<pre><code>## Warning in log(q^2 + 2 * q * r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(2 * p * q): 产生了NaNs</code></pre>
<pre><code>## Warning in log(q^2 + 2 * q * r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(2 * p * q): 产生了NaNs</code></pre>
<pre><code>## Warning in log(r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(2 * p * q): 产生了NaNs</code></pre>
<pre><code>## Warning in log(p^2 + 2 * p * r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(q^2 + 2 * q * r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(p^2 + 2 * p * r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(q^2 + 2 * q * r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(p^2 + 2 * p * r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(q^2 + 2 * q * r): 产生了NaNs</code></pre>
<pre><code>## Warning in log(r): 产生了NaNs</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>p0 &lt;-<span class="st"> </span>pq[<span class="dv">1</span>]</span>
<span id="cb72-2"><a href="#cb72-2"></a>q0 &lt;-<span class="st"> </span>pq[<span class="dv">2</span>]</span>
<span id="cb72-3"><a href="#cb72-3"></a>r0 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0</span>
<span id="cb72-4"><a href="#cb72-4"></a>pqr[<span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">c</span>(p0,q0,r0)</span>
<span id="cb72-5"><a href="#cb72-5"></a>ll[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">l</span>(pq)</span>
<span id="cb72-6"><a href="#cb72-6"></a></span>
<span id="cb72-7"><a href="#cb72-7"></a><span class="co">#the conditional likelihood</span></span>
<span id="cb72-8"><a href="#cb72-8"></a>El &lt;-<span class="st"> </span><span class="cf">function</span>(x,m){</span>
<span id="cb72-9"><a href="#cb72-9"></a>  p &lt;-<span class="st"> </span>x[<span class="dv">1</span>]</span>
<span id="cb72-10"><a href="#cb72-10"></a>  q &lt;-<span class="st"> </span>x[<span class="dv">2</span>]</span>
<span id="cb72-11"><a href="#cb72-11"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb72-12"><a href="#cb72-12"></a>  base &lt;-<span class="st"> </span><span class="kw">c</span>(p<span class="op">^</span><span class="dv">2</span>,<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r,q<span class="op">^</span><span class="dv">2</span>,<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r,r<span class="op">^</span><span class="dv">2</span>,<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)</span>
<span id="cb72-13"><a href="#cb72-13"></a>  <span class="kw">return</span>(<span class="op">-</span><span class="kw">sum</span>(<span class="kw">log</span>(base)<span class="op">*</span>m))</span>
<span id="cb72-14"><a href="#cb72-14"></a>      </span>
<span id="cb72-15"><a href="#cb72-15"></a>}</span>
<span id="cb72-16"><a href="#cb72-16"></a></span>
<span id="cb72-17"><a href="#cb72-17"></a><span class="co">#EM estimatimate</span></span>
<span id="cb72-18"><a href="#cb72-18"></a>i &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb72-19"><a href="#cb72-19"></a><span class="cf">while</span>((i <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)<span class="op">||</span>(<span class="kw">abs</span>(ll[i]<span class="op">-</span>ll[i<span class="dv">-1</span>]) <span class="op">&gt;</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span>)){</span>
<span id="cb72-20"><a href="#cb72-20"></a>p &lt;-<span class="st"> </span>pqr[i,<span class="dv">1</span>]</span>
<span id="cb72-21"><a href="#cb72-21"></a>q &lt;-<span class="st"> </span>pqr[i,<span class="dv">2</span>]</span>
<span id="cb72-22"><a href="#cb72-22"></a>r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb72-23"><a href="#cb72-23"></a>nAA &lt;-<span class="st"> </span>nA <span class="op">*</span><span class="st"> </span>p<span class="op">/</span>(p<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r)</span>
<span id="cb72-24"><a href="#cb72-24"></a>nAO &lt;-<span class="st"> </span>nA <span class="op">-</span><span class="st"> </span>nAA</span>
<span id="cb72-25"><a href="#cb72-25"></a>nBB &lt;-<span class="st"> </span>nB <span class="op">*</span><span class="st"> </span>q<span class="op">/</span>(q<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r)</span>
<span id="cb72-26"><a href="#cb72-26"></a>nBO &lt;-<span class="st"> </span>nB <span class="op">-</span><span class="st"> </span>nBB</span>
<span id="cb72-27"><a href="#cb72-27"></a>m &lt;-<span class="st"> </span><span class="kw">c</span>(nAA,nAO,nBB,nBO,nO,nAB)</span>
<span id="cb72-28"><a href="#cb72-28"></a>res &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(p,q),El,<span class="dt">method=</span><span class="st">&quot;CG&quot;</span>,<span class="dt">m=</span>m) </span>
<span id="cb72-29"><a href="#cb72-29"></a>i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb72-30"><a href="#cb72-30"></a>pqr[i,] &lt;-<span class="st"> </span><span class="kw">c</span>(res<span class="op">$</span>par,<span class="dv">1</span><span class="op">-</span>res<span class="op">$</span>par[<span class="dv">1</span>]<span class="op">-</span>res<span class="op">$</span>par[<span class="dv">2</span>])</span>
<span id="cb72-31"><a href="#cb72-31"></a>ll[i] &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">l</span>(pqr[i,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])   <span class="co">#the corresponding log-maximum likelihood values (for observed data)</span></span>
<span id="cb72-32"><a href="#cb72-32"></a>}</span>
<span id="cb72-33"><a href="#cb72-33"></a></span>
<span id="cb72-34"><a href="#cb72-34"></a><span class="co">#create table and graph</span></span>
<span id="cb72-35"><a href="#cb72-35"></a>pql &lt;-<span class="st"> </span><span class="kw">cbind</span>(pqr[<span class="dv">1</span><span class="op">:</span>i,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],ll[<span class="dv">1</span><span class="op">:</span>i])  <span class="co">#i is the iteration times</span></span>
<span id="cb72-36"><a href="#cb72-36"></a><span class="kw">round</span>(pql,<span class="dv">6</span>)</span></code></pre></div>
<pre><code>##          [,1]     [,2]      [,3]
## [1,] 0.297641 0.102709 -1169.822
## [2,] 0.297641 0.102709 -1169.822</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(pql,<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;q&quot;</span>,<span class="st">&quot;loglikValue&quot;</span>),<span class="dt">align =</span> <span class="st">&quot;c&quot;</span>,<span class="dt">caption=</span><span class="st">&quot;EM estimates&quot;</span>)</span></code></pre></div>
<table>
<caption>EM estimates</caption>
<thead>
<tr class="header">
<th align="center">p</th>
<th align="center">q</th>
<th align="center">loglikValue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.2976412</td>
<td align="center">0.1027089</td>
<td align="center">-1169.822</td>
</tr>
<tr class="even">
<td align="center">0.2976412</td>
<td align="center">0.1027089</td>
<td align="center">-1169.822</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">plot</span>(pql[,<span class="dv">3</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> analysis:base on machine percision, (p,q) converge into (0.2976412, 0.1027089)</p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb76-2"><a href="#cb76-2"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb76-3"><a href="#cb76-3"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb76-4"><a href="#cb76-4"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb76-5"><a href="#cb76-5"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb76-6"><a href="#cb76-6"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb76-7"><a href="#cb76-7"></a>)</span>
<span id="cb76-8"><a href="#cb76-8"></a><span class="kw">lapply</span>(formulas, lm)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb78-2"><a href="#cb78-2"></a>  <span class="kw">lm</span>(formulas[[i]])</span>
<span id="cb78-3"><a href="#cb78-3"></a>}</span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="kw">detach</span>(mtcars)</span></code></pre></div>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate(100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co">#Use sapply() and an anonymous function</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>pvalue1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb79-3"><a href="#cb79-3"></a>pvalue2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb79-4"><a href="#cb79-4"></a>results &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb79-5"><a href="#cb79-5"></a>i &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb79-6"><a href="#cb79-6"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>,</span>
<span id="cb79-7"><a href="#cb79-7"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb79-8"><a href="#cb79-8"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb79-9"><a href="#cb79-9"></a>)</span>
<span id="cb79-10"><a href="#cb79-10"></a>pvalue1 &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span>
<span id="cb79-11"><a href="#cb79-11"></a></span>
<span id="cb79-12"><a href="#cb79-12"></a><span class="co">#Extra challenge</span></span>
<span id="cb79-13"><a href="#cb79-13"></a>results &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>,<span class="dt">expr =</span> {</span>
<span id="cb79-14"><a href="#cb79-14"></a>pvalue2 &lt;-<span class="st"> </span><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>))<span class="op">$</span>p.value</span>
<span id="cb79-15"><a href="#cb79-15"></a>},<span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb79-16"><a href="#cb79-16"></a>pvalue2 &lt;-<span class="st"> </span><span class="kw">unlist</span>(results)</span></code></pre></div>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="kw">library</span>(parallel)</span>
<span id="cb80-3"><a href="#cb80-3"></a></span>
<span id="cb80-4"><a href="#cb80-4"></a>Mapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){</span>
<span id="cb80-5"><a href="#cb80-5"></a>  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X)</span>
<span id="cb80-6"><a href="#cb80-6"></a>  <span class="cf">if</span>(simplify <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){<span class="kw">return</span>(<span class="kw">simplify2array</span>(out))}</span>
<span id="cb80-7"><a href="#cb80-7"></a>  out</span>
<span id="cb80-8"><a href="#cb80-8"></a>}</span>
<span id="cb80-9"><a href="#cb80-9"></a></span>
<span id="cb80-10"><a href="#cb80-10"></a><span class="co">#example</span></span>
<span id="cb80-11"><a href="#cb80-11"></a>data1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb80-12"><a href="#cb80-12"></a>data2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb80-13"><a href="#cb80-13"></a>data &lt;-<span class="st"> </span><span class="kw">cbind</span>(data1,data2)</span>
<span id="cb80-14"><a href="#cb80-14"></a><span class="kw">Mapply</span>(data,mean,<span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.6264538
## 
## [[2]]
## [1] 0.1836433
## 
## [[3]]
## [1] -0.8356286
## 
## [[4]]
## [1] 1.595281
## 
## [[5]]
## [1] 0.3295078
## 
## [[6]]
## [1] -0.8204684
## 
## [[7]]
## [1] 0.4874291
## 
## [[8]]
## [1] 0.7383247
## 
## [[9]]
## [1] 0.5757814
## 
## [[10]]
## [1] -0.3053884
## 
## [[11]]
## [1] 1.511781
## 
## [[12]]
## [1] 0.3898432
## 
## [[13]]
## [1] -0.6212406
## 
## [[14]]
## [1] -2.2147
## 
## [[15]]
## [1] 1.124931
## 
## [[16]]
## [1] -0.04493361
## 
## [[17]]
## [1] -0.06476105
## 
## [[18]]
## [1] 3.775345
## 
## [[19]]
## [1] 3.284885
## 
## [[20]]
## [1] 2.375605
## 
## [[21]]
## [1] 3.675909
## 
## [[22]]
## [1] 3.128545
## 
## [[23]]
## [1] 0.2982599
## 
## [[24]]
## [1] -7.957407
## 
## [[25]]
## [1] 2.479303
## 
## [[26]]
## [1] -0.224515
## 
## [[27]]
## [1] -0.623182
## 
## [[28]]
## [1] -5.88301
## 
## [[29]]
## [1] -1.9126
## 
## [[30]]
## [1] 1.671766
## 
## [[31]]
## [1] 5.434718
## 
## [[32]]
## [1] -0.4111509</code></pre>
</div>
</div>
<div id="section-9" class="section level1">
<h1><font color="Teal">2020/12/07</font></h1>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<p>解：</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="kw">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="kw">library</span>(StatComp20040)</span>
<span id="cb84-2"><a href="#cb84-2"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb84-3"><a href="#cb84-3"></a>sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb84-4"><a href="#cb84-4"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb84-5"><a href="#cb84-5"></a>rw1 =<span class="st"> </span><span class="kw">rwc</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb84-6"><a href="#cb84-6"></a>rw2 =<span class="st"> </span><span class="kw">rwc</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb84-7"><a href="#cb84-7"></a>rw3 =<span class="st"> </span><span class="kw">rwc</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb84-8"><a href="#cb84-8"></a>rw4 =<span class="st"> </span><span class="kw">rwc</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb84-9"><a href="#cb84-9"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb84-10"><a href="#cb84-10"></a>Rej =<span class="st"> </span><span class="kw">cbind</span>(rw1[[<span class="dv">2</span>]], rw2[[<span class="dv">2</span>]], rw3[[<span class="dv">2</span>]], rw4[[<span class="dv">2</span>]])</span>
<span id="cb84-11"><a href="#cb84-11"></a>Acc =<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>Rej)<span class="op">/</span>N,<span class="dv">4</span>)</span>
<span id="cb84-12"><a href="#cb84-12"></a><span class="kw">rownames</span>(Acc) =<span class="st"> &quot;Accept rates&quot;</span></span>
<span id="cb84-13"><a href="#cb84-13"></a><span class="kw">colnames</span>(Acc) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)</span>
<span id="cb84-14"><a href="#cb84-14"></a>knitr<span class="op">::</span><span class="kw">kable</span>(Acc)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">sigma 0.05</th>
<th align="right">sigma 0.5</th>
<th align="right">sigma 2</th>
<th align="right">sigma 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Accept rates</td>
<td align="right">0.9775</td>
<td align="right">0.833</td>
<td align="right">0.5225</td>
<td align="right">0.0995</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co">#plot</span></span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))  <span class="co">#display 4 graphs together</span></span>
<span id="cb85-3"><a href="#cb85-3"></a>rw =<span class="st"> </span><span class="kw">cbind</span>(rw1[[<span class="dv">1</span>]], rw2[[<span class="dv">1</span>]], rw3[[<span class="dv">1</span>]], rw4[[<span class="dv">1</span>]])</span>
<span id="cb85-4"><a href="#cb85-4"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb85-5"><a href="#cb85-5"></a>        <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb85-6"><a href="#cb85-6"></a>             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb85-7"><a href="#cb85-7"></a>             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb85-8"><a href="#cb85-8"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">library</span>(StatComp20040)</span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb86-3"><a href="#cb86-3"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb86-4"><a href="#cb86-4"></a>sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb86-5"><a href="#cb86-5"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb86-6"><a href="#cb86-6"></a>rw1 =<span class="st"> </span><span class="kw">rwc</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb86-7"><a href="#cb86-7"></a>rw2 =<span class="st"> </span><span class="kw">rwc</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb86-8"><a href="#cb86-8"></a>rw3 =<span class="st"> </span><span class="kw">rwc</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb86-9"><a href="#cb86-9"></a>rw4 =<span class="st"> </span><span class="kw">rwc</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb86-10"><a href="#cb86-10"></a></span>
<span id="cb86-11"><a href="#cb86-11"></a>rwr1 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb86-12"><a href="#cb86-12"></a>rwr2 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb86-13"><a href="#cb86-13"></a>rwr3 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb86-14"><a href="#cb86-14"></a>rwr4 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb86-15"><a href="#cb86-15"></a></span>
<span id="cb86-16"><a href="#cb86-16"></a>rw =<span class="st"> </span><span class="kw">cbind</span>(rw1[[<span class="dv">1</span>]], rw2[[<span class="dv">1</span>]], rw3[[<span class="dv">1</span>]], rw4[[<span class="dv">1</span>]])</span>
<span id="cb86-17"><a href="#cb86-17"></a>rwr =<span class="st"> </span><span class="kw">cbind</span>(rwr1<span class="op">$</span>x, rwr2<span class="op">$</span>x, rwr3<span class="op">$</span>x,  rwr4<span class="op">$</span>x)</span>
<span id="cb86-18"><a href="#cb86-18"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))  <span class="co">#display 4 graphs together</span></span>
<span id="cb86-19"><a href="#cb86-19"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb86-20"><a href="#cb86-20"></a><span class="kw">qqplot</span>(rw[,j], rwr[,j],<span class="dt">main=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))))</span>
<span id="cb86-21"><a href="#cb86-21"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>Compare the computation time of the two functions with the function “microbenchmark”.</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">library</span>(StatComp20040)</span>
<span id="cb89-2"><a href="#cb89-2"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb89-3"><a href="#cb89-3"></a>sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb89-4"><a href="#cb89-4"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb89-5"><a href="#cb89-5"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwc1 =</span> <span class="kw">rwc</span>(sigma[<span class="dv">1</span>],x0,N),<span class="dt">rwr1 =</span> <span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N),<span class="dt">times =</span> <span class="dv">4</span>)</span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq  median      uq
## 1 rwc1  231.10  239.00  247.40
## 2 rwr1 5712.05 5989.65 6673.25</code></pre>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>Comments your results.</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4</h2>
<p>from the qqplot, we can see that generated random numbers with two different style code have the similar distribution when <span class="math inline">\(\sigma=0.05\)</span>,other situation have larger difference; from the elapsed time,we can find that, operating with cpp code has higher efficiency, and spend less time than original code.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
